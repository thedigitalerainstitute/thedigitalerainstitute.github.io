<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Best State Economy 2024</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css">
    <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/fonts.css">
    <link rel="stylesheet" href="/css/index.css">
    <style>
        .map {
            width: 50%;
            margin: 0 auto;
            border: 2px solid #444;
            padding: 1rem;
            background-color: #333;
            color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
            border-radius: 1rem;
        }
        h1, h3, h4, p {
            text-align: center;
            font-family: 'Inter', sans-serif;
            color: #fff;
            
        }
        ul, li {
            text-shadow: 0px 3px 6px rgb(0, 0, 0);
        }
        table.dataTable {
            width: 80%;
            margin: 2em auto;
            border-collapse: separate;
            border-spacing: 0;
            font-family: 'Inter', sans-serif;
            border-radius: 2rem;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
            background-color: #333;
            color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
        }

        table.dataTable thead th {
            background-color: #444;
            text-align: center;
            padding: 0.75em;
            font-weight: 500;
            border-bottom: 1px solid #555;
        }

        table.dataTable tbody tr:nth-child(even) {
            background-color: #444;
        }

        table.dataTable th,
        table.dataTable td {
            padding: 0.75em;
            text-align: center;
            border-right: 1px solid #555;
        }

        table.dataTable th:last-child,
        table.dataTable td:last-child {
            border-right: none;
        }
        .title {
            font-size: 4em;
            margin: 1em 0;
        }
        .dataTables_wrapper .dataTables_length,
        .dataTables_wrapper .dataTables_filter,
        .dataTables_wrapper .dataTables_paginate,
        .dataTables_wrapper .dataTables_info {
            margin: 1em 2em;
            font-family: 'Inter', sans-serif;
            color: #fff;
        }
        .dataTables_wrapper .dataTables_length label,
        .dataTables_wrapper .dataTables_filter label {
            display: inline-flex;
            align-items: center;
            gap: 0.5em;
            text-shadow: 0px 3px 6px rgb(0, 0, 0);
        }
        .dataTables_wrapper .dataTables_filter input[type="search"] {
            border: 1px solid #555;
            border-radius: 0.3em;
            padding: 0.35em;
            background-color: #444;
            color: #fff;
            text-shadow: 0px 3px 6px rgb(0, 0, 0);
        }
        .dataTables_wrapper .dataTables_paginate .paginate_button {
            background-color: #444;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 0.3em 0.6em;
            margin: 0 3px;
            cursor: pointer;
            color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
        }
        .dataTables_wrapper .dataTables_paginate .paginate_button.current {
            background-color: #555;
        }
        .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
            background-color: #666;
        }
        .downloadBtn {
            display: block;
            margin: 2em auto;
            padding: 1em 2em;
            font-size: 1.2em;
            background-color: #444;
            border: 1px solid #555;
            border-radius: 0.5em;
            cursor: pointer;
            color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
        }
        .downloadBtn:hover {
            background-color: #1c1c1c;
        }
        body {
            background: #2b2b2d;
            color: #fff;
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
        }
        a {
            color: #69b4ff;
            text-decoration: none;
        }

        a:hover {
            color: #ff8e7a;
            text-decoration: underline;
        }
        
        .dataTables_wrapper .dataTables_length select {
            background-color: #444;
            color: #fff;
            border: 1px solid #555;
            border-radius: 0.3em;
            padding: 0.35em;
            text-shadow: 0px 3px 6px rgb(0, 0, 0);
        }

        @media only screen and (max-width: 768px) {
            .map {
                width: 90%;
                padding: 0rem;
            }
            .title {
                font-size: 2.5em;
            }
            table.dataTable {
                width: 100%;
            }
            table.dataTable th, table.dataTable td {
                padding: 0.5em;
            }
            .downloadBtn {
                width: 80%;
                font-size: 1em;
            }
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #444;
            background: #2b2b2d;
            padding: 5px 20px;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }
        .navbar-brand {
            font-family: 'Teko', sans-serif;
            font-size: 24px;
            color: white;
        }
        .navbar-brand .dot {
            color: orange;
        }
        /* Always display navbar-toggle */
        .navbar-toggle {
            display: flex;
            flex-direction: column;
            cursor: pointer;
            margin-right: 30px;
        }
        .navbar-toggle .bar {
            height: 3px;
            width: 25px;
            background-color: white;
            margin: 4px 0;
        }
        /* Hide menu by default, toggle with .active */
        .navbar-menu {
            list-style: none;
            margin: 0;
            padding: 0;
            display: none;
            position: absolute;
            top: 40px; 
            right: 40px; 
            background-color: #2b2b2d;
            flex-direction: column;
        }
        .navbar-menu.active {
            display: block;
        }
        .navbar-item {
            margin: 10px 20px;
            font-family: Teko, sans-serif;
            font-size: x-large;
            text-align: center;
        }
        .navbar-item:hover {
            background-color: rgb(15, 15, 16);
        }
        .navbar-item a {
            color: white;
            text-decoration: none;
        }
        /* Optional: adjust for larger screens if desired */
        @media (min-width: 769px) {
            .navbar-menu {
            flex-direction: row;
            }
        }
        .hero-section {
            padding-top: 60px; /* Adjust padding to avoid overlap with fixed navbar */
        }
    </style>
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-brand" onclick="window.location.href='/';">
            thedigitalera<span class="dot">.</span>org
        </div>
        <!-- Keep navbar-toggle always visible -->
        <div class="navbar-toggle" id="mobile-menu">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </div>
        <ul class="navbar-menu">
            <li class="navbar-item"><a href="/">Home</a></li>
            <li class="navbar-item"><a href="#">About</a></li>
            <li class="navbar-item"><a href="#">Videos</a></li>
            <li class="navbar-item"><a href="#">Publications</a></li>
        </ul>
    </nav>
    <script>
        const mobileMenu = document.getElementById('mobile-menu');
        const navbarMenu = document.querySelector('.navbar-menu');

        mobileMenu.addEventListener('click', () => {
            navbarMenu.classList.toggle('active');
        });
    </script>
    <h1 class="title" style="padding-top: 60px;">States With The Best Economy 2024</h1>
    <div class="map">
        <h3>In the last election, people complained about the economy being bad while politicians said the GDP was rising. Both were correct, but talking about different things.</h3>
        <p>Mississippi has a similar GDP per capita to Germany, but the quality of life in Germany is far better. GDP does not measure what normal people care about. These metrics are here to address that issue.</p>
    </div>
    <h1>Philosophical Principles</h1>
    <div class="map">
        <ul>
            <li>The effectiveness of an economy is based on whether an average person can satisfy their needs, not a number being high</li>
            <li>Quality of goods used to satisfy needs explains difference between more developed economies. (A 4 bedroom house in America is nicer than a 4 bedroom house in India, or even just nicer areas within America). Economic Efficacy does not measure quality, only if the goods are affordable.</li>
            <li>A person's needs are the following categories:
                <ul>
                    <li>Survival: food, shelter, water, clothing (which we will omit since cost of clothing is dependent on taste, some people can wear the same clothes for years), childcare, healthcare</li>
                    <li>Basic Needs(<i>try living in society without these</i>): Electricity, Internet, Mobile Plans, Car</li>
                </ul>
            </li>
        </ul>
    </div>
    <h1>Total Cost for Family of Four</h1>
    <h3>Only for essentials, excludes discretionary spending or one off necessary spending like clothes. For closer to true cost, add 20-30%</h3>
    <div class="map" id="familyoffour"></div>
    <h1>Total Cost for Single Person</h1>
    <h3>Only for essentials, excludes discretionary spending or one off necessary spending like clothes. For closer to true
        cost, add 20-30%</h3>
    <div class="map" id="single"></div>
    <h1>Leftover Income for Family of Four</h1>
    <h3>How much money does a family of four have leftover after paying for essentials?</h3>
    <div class="map" id="familyoffournet"></div>
    <h1>Leftover Income for Single Person</h1>
    <h3>How much money does a single person have leftover after paying for essentials?</h3>
    <div class="map" id="singlenet"></div>
    <h1>Average Income Leftover</h1>
    <h3>(Income of Family + Single Person) / 2</h3>
    <div class="map" id="avg-income-leftover"></div>
    <h1>Percent Income Used On Essentials for Family of Four</h1>
    <div class="map" id="essentials-family"></div>
    <h1>Percent Income Used On Essentials for Single Person</h1>
    <div class="map" id="essentials-single"></div>
    <h1>Average Percent Income Used On Essentials</h1>
    <h3>(Percent Income Used On Essentials for Family of Four + Percent Income Used On Essentials for Single Person) / 2</h3>
    <div class="map" id="avg-essentials"></div>

    <h1>Difference in Cost of Family vs Being Single</h1>
    <h3>How much more expensive is it to have a family?</h3>
    <div class="map" id="family-single"></div>
    <h1>Leftover Income for Family vs Single Person</h1>
    <h3>How much better are families doing compared to a single person?</h3>
    <div class="map" id="net-family-single"></div>
    <h1>Data</h1>
    <table id="myData" class="display"></table>
    <button class="downloadBtn" id="downloadBtn">Download CSV</button>
    <button class="downloadBtn" id="downloadBtnRaw">Download Raw Data CSV</button>

    <h1 class="title">Methodology</h1>
    <h1>Data Tracked:</h1>
    <div class="map">
        <ul>
            <li>Median Gross Family Income - 4 people</li>
            <li>Median Gross Income - Single Person</li>
            <li>Yearly Cost of Rent for a Four Bedroom Home</li>
            <li>Yearly Cost of Rent for a Studio</li>
            <li>Yearly Cost of Childcare</li>
            <li>Child Tax Credit based on Average Income of State and one kid under 6 and one kid over</li>
            <li>Yearly Cost of Grocery</li>
            <li>Yearly Cost of Water</li>
            <li>Yearly Cost of Electricity</li>
            <li>Yearly Cost of Internet</li>
            <li>Yearly Cost of Mobile plan (factoring in tax, assuming single line is 60 and 4 lines is 120)</li>
            <li>Yearly Cost of Car+Insurance+Gas</li>
            <li>Yearly Cost of Healthcare</li>
        </ul>
    </div>
    <h1>Formulas</h1>
    <div class="map">
        <ul>
            <li>Total Cost for Family of Four = Yearly 4 Bedroom Rent + (Yearly Childcare * 2) - (Yearly Child Tax Credit) + (Yearly Grocery * 3.5) + (Yearly Water * 4) + (Yearly Electricity * 4) + Yearly Internet + (Yearly Mobile Plan Tax * Mobile Plan Family) + (Yearly Car * 2) + (Yearly Healthcare * 4)</li>
            <li>Total Cost for Single Person = Yearly Studio Rent + Yearly Grocery + Yearly Water + Yearly Electricity + (Yearly Mobile Plan Tax * Mobile Plan Single) + Yearly Internet + Yearly Car + Yearly Healthcare</li>
            <li>Leftover Income for Family of Four = Median Family Income - Total Cost for Family of Four</li>
            <li>Leftover Income for Single Person = Median Single Income - Total Cost for Single Person</li>
            <li>Percent Income Used On Essentials for Family of Four = (Total Cost for Family of Four / Median Family Income) * 100</li>
            <li>Percent Income Used On Essentials for Single Person = (Total Cost for Single Person / Median Single Income) * 100</li>
            <li>Average Percent Income Used On Essentials = (Percent Income Used On Essentials for Family of Four + Percent Income Used On Essentials for Single Person) / 2</li>
            <li>Average Income Leftover = (Leftover Income for Family of Four + Leftover Income for Single Person) / 2</li>
        </ul>
    </div>
    <h1>Drawbacks/Limitations</h1>
    <div class="map">
        <ul>
            <li>Doesn't account for one off necessary purchases, such as a new phone, clothes, etc.</li>
            <li>Or other expenditures that aren't necessary but are important such as investment/savings, extra education, extracurriculars</li>
            <li>People who are parents make more, which could happen because people who are financially well off are more likely to start a family</li>
            <li>Doesn't factor owning a home, since it's harder to calculate a monthly cost for it given variables like downpayment</li>
            <li>Does not include child tax credits per state, that would be its own project</li>
        </ul>
    </div>

    <h1 class="title">Supporting data</h1>
    <h1>Median Income after Tax for Family of Four</h1>
    <div class="map" id="familyoffourincome"></div>
    <h1>Median Income after Tax for Single Person</h1>
    <div class="map" id="singleincome"></div>
    <h1>Yearly Studio Rent</h1>
    <h3>How much does it cost to rent a studio apartment in each state?</h3>
    <div class="map" id="studio-rent"></div>
    <h1>Yearly 4 Bedroom Rent</h1>
    <h3>How much does it cost to rent a 4 bedroom in each state?</h3>
    <div class="map" id="4-bedroom-rent"></div>
    <h1>Yearly Childcare</h1>
    <div class="map" id="childcare"></div>
    <h1>Child Tax Credit</h1>
    <div class="map" id="child-tax-credit"></div>
    <h1>Yearly Grocery</h1>
    <div class="map" id="grocery"></div>
    <h1>Yearly Water</h1>
    <div class="map" id="water"></div>
    <h1>Yearly Electricity</h1>
    <div class="map" id="electricity"></div>
    <h1>Yearly Internet</h1>
    <div class="map" id="internet"></div>
    <h1>Yearly Mobile Plan Tax Rate</h1>
    <div class="map" id="mobile-plan"></div>
    <h1>Yearly Cost for 1 Car</h1>
    <div class="map" id="car"></div>
    <h1>Yearly Healthcare</h1>
    <div class="map" id="healthcare"></div>

    <h1>Supporting Data</h1>
    <table id="miscData" class="display"></table>
    <button class="downloadBtn" id="downloadMiscBtn">Download Supporting Data CSV</button>

    <script>
        document.getElementById("downloadMiscBtn").addEventListener("click", function() {
            d3.csv("MyData/final_dataset.csv").then(function(data) {
                let miscHeaders = [
                    "State",
                    "Yearly Studio Rent",
                    "Yearly 4 Bedroom Rent",
                    "Yearly Childcare",
                    "Child Tax Credit",
                    "Yearly Grocery",
                    "Yearly Water",
                    "Yearly Electricity",
                    "Yearly Internet",
                    "Yearly Mobile Plan Tax Rate",
                    "Yearly Cost for 1 Car",
                    "Yearly Healthcare"
                ];
                let allRows = [];
                allRows.push(miscHeaders.join(","));
                data.forEach(row => {
                    let rowData = miscHeaders.map(h => row[h]);
                    allRows.push(rowData.join(","));
                });
                let csvContent = allRows.join("\n");
                let blob = new Blob([csvContent], { type: "text/csv" });
                let url = URL.createObjectURL(blob);
                let link = document.createElement("a");
                link.href = url;
                link.download = "misc_data.csv";
                link.click();
                URL.revokeObjectURL(url);
            });
        });
    </script>
    <script>
        d3.csv("MyData/final_dataset.csv").then(function(data) {
            let miscHeaders = [
                "State",
                "Yearly Studio Rent",
                "Yearly 4 Bedroom Rent",
                "Yearly Childcare",
                "Child Tax Credit",
                "Yearly Grocery",
                "Yearly Water",
                "Yearly Electricity",
                "Yearly Internet",
                "Yearly Mobile Plan Tax Rate",
                "Yearly Cost for 1 Car",
                "Yearly Healthcare"
            ];
            let miscTable = d3.select("#miscData");
            let miscThead = miscTable.append("thead").append("tr");
            miscHeaders.forEach(h => miscThead.append("th").text(h));
            let miscTbody = miscTable.append("tbody");
            data.forEach(row => {
                let tr = miscTbody.append("tr");
                miscHeaders.forEach(h => {
                    let value = row[h];
                    let num = parseFloat(value);
                    if (!isNaN(num)) {
                        value = num.toFixed(2);
                    }
                    tr.append("td").text(value);
                });
            });
            $('#miscData').DataTable();
        });
    </script>

    <h1>References</h1>
    <div class="map">
        <ul>
            <li>Median Income: <a href="https://www.justice.gov/ust/eo/bapcpa/20240401/bci_data/median_income_table.htm" target="_blank">https://www.justice.gov/ust/eo/bapcpa/20240401/bci_data/median_income_table.htm</a></li>
            <li>Rent: <a href="https://rentalrealestate.com/data/rent/new-jersey/" target="_blank">https://rentalrealestate.com/data/rent/new-jersey/</a></li>
            <li>Cost of Childcare: <a href="https://worldpopulationreview.com/state-rankings/child-care-costs-by-state" target="_blank">https://worldpopulationreview.com/state-rankings/child-care-costs-by-state</a></li>
            <li>Child Tax Credit: <a href="https://dig.abclocal.go.com/ccg/interactives/child-tax-credit-calculator/index.html" target="_blank">https://dig.abclocal.go.com/ccg/interactives/child-tax-credit-calculator/index.html</a></li>
            <li>Cost of Groceries: <a href="https://worldpopulationreview.com/state-rankings/grocery-prices-by-state" target="_blank">https://worldpopulationreview.com/state-rankings/grocery-prices-by-state</a></li>
            <li>Cost of Water: <a href="https://worldpopulationreview.com/state-rankings/water-prices-by-state" target="_blank">https://worldpopulationreview.com/state-rankings/water-prices-by-state</a></li>
            <li>Cost of Electricity: <a href="https://www.eia.gov/electricity/monthly/epm_table_grapher.php?t=epmt_5_6_a" target="_blank">https://www.eia.gov/electricity/monthly/epm_table_grapher.php?t=epmt_5_6_a</a></li>
            <li>Cost of Internet: <a href="https://finance.yahoo.com/news/servicetitan-initiated-outperform-baird-125506702.html" target="_blank">https://finance.yahoo.com/news/servicetitan-initiated-outperform-baird-125506702.html</a></li>
            <li>Mobile Plan Taxes: <a href="https://taxfoundation.org/data/all/state/wireless-taxes-cell-phone-tax-rates-by-state-2024/" target="_blank">https://taxfoundation.org/data/all/state/wireless-taxes-cell-phone-tax-rates-by-state-2024/</a></li>
            <li>Cost of a car: <a href="https://www.gobankingrates.com/saving-money/car/cost-owning-car-by-state/" target="_blank">https://www.gobankingrates.com/saving-money/car/cost-owning-car-by-state/</a></li>
            <li>Cost of Healthcare: <a href="https://worldpopulationreview.com/state-rankings/health-care-costs-by-state" target="_blank">https://worldpopulationreview.com/state-rankings/health-care-costs-by-state</a></li>
        </ul>
    </div>

    <button class="downloadBtn" onclick="window.location.href='https://github.com/mahi-pas/Economic-Efficacy/tree/main'">View Project on GitHub</button>

    <script>
        d3.csv("https://raw.githubusercontent.com/mahi-pas/Economic-Efficacy/refs/heads/main/MyData/final_dataset.csv").then(function(data) {
            let locations = data.map(row => row['State Code']);
            let values = data.map(row => row['Total Cost for Family of 4']);

            const more_is_green = [
                ['0.0', 'rgb(141, 17, 17)'],
                ['0.111111111111', 'rgb(163, 42, 1)'],
                ['0.222222222222', 'rgb(182, 66, 0)'],
                ['0.333333333333', 'rgb(195, 90, 0)'],
                ['0.444444444444', 'rgb(202, 115, 0)'],
                ['0.555555555556', 'rgb(203, 141, 0)'],
                ['0.666666666667', 'rgb(197, 168, 0)'],
                ['0.777777777778', 'rgb(178, 197, 0)'],
                ['0.888888888889', 'rgb(147, 224, 0)'],
                ['1.0', 'rgb(30, 255, 0)']
            ];

            const more_is_green_small_range = [
                ['0.0', 'rgb(197, 168, 0)'],
                ['0.111111111111', 'rgb(194, 176, 0)'],
                ['0.222222222222', 'rgb(191, 184, 0)'],
                ['0.333333333333', 'rgb(186, 193, 0)'],
                ['0.444444444444', 'rgb(179, 202, 0)'],
                ['0.555555555556', 'rgb(168, 212, 0)'],
                ['0.666666666667', 'rgb(155, 222, 0)'],
                ['0.777777777778', 'rgb(134, 233, 0)'],
                ['0.888888888889', 'rgb(103, 243, 0)'],
                ['1.0', 'rgb(30, 255, 0)']
            ];

            const less_is_green = [
                ['0.0', 'rgb(30, 255, 0)'],
                ['0.111111111111', 'rgb(147, 224, 0)'],
                ['0.222222222222', 'rgb(178, 197, 0)'],
                ['0.333333333333', 'rgb(197, 168, 0)'],
                ['0.444444444444', 'rgb(203, 141, 0)'],
                ['0.555555555556', 'rgb(202, 115, 0)'],
                ['0.666666666667', 'rgb(195, 90, 0)'],
                ['0.777777777778', 'rgb(182, 66, 0)'],
                ['0.888888888889', 'rgb(163, 42, 1)'],
                ['1.0', 'rgb(141, 17, 17)']
            ];

            let trace = {
                type: 'choropleth',
                locationmode: 'USA-states',
                locations: locations,
                z: values,
                colorscale: less_is_green,
            };

            let layout = {
                title: 'Total Cost for Family of Four<br><sup>Only for essentials, excludes discretionary spending or one off necessary spending like clothes.</sup>',
                geo: { scope: 'usa' },
                margin: { t: 50, b: 0 },
                annotations: [{
                    text: 'Only for essentials, excludes discretionary spending or one off necessary spending like clothes. For closer to true cost, add 20-30%',
                    showarrow: false,
                    align: 'center',
                    x: 0.5,
                    y: -0.1,
                    xref: 'paper',
                    yref: 'paper',
                    xanchor: 'center',
                    yanchor: 'top',
                    font: {
                        size: 12
                    }
                }]
            };

            // Existing plots
            Plotly.newPlot('familyoffour', [trace], layout);
            trace.z = data.map(row => row['Median Family Income']);
            trace.colorscale = more_is_green;
            layout.title = 'Median Income after Tax for Family of Four';
            Plotly.newPlot('familyoffourincome', [trace], layout);
            trace.z = data.map(row => row['Leftover Income for Family of Four']);
            layout.title = 'Leftover Income for Family of Four<br><sup>How much money does a family of four have leftover after paying for essentials?</sup>';
            layout.subtitle = 'How much money does a family of four have leftover after paying for essentials?';
            Plotly.newPlot('familyoffournet', [trace], layout);
            trace.z = data.map(row => row['Total Cost for Single Person']);
            trace.colorscale = less_is_green;
            layout.title = 'Total Cost for Single Person<br><sup>Only for essentials, excludes discretionary spending or one off necessary spending like clothes.</sup>';
            layout.subtitle = 'Only for essentials, excludes discretionary spending or one off necessary spending like clothes. For closer to true cost, add 20-30%';
            Plotly.newPlot('single', [trace], layout);
            trace.z = data.map(row => row['Median Single Income']);
            trace.colorscale = more_is_green;
            layout.title = 'Median Income after Tax for Single Person';
            layout.subtitle = '';
            Plotly.newPlot('singleincome', [trace], layout);
            trace.z = data.map(row => row['Leftover Income for Single Person']);
            layout.title = 'Leftover Income for Single Person<br><sup>How much money does a single person have leftover after paying for essentials?</sup>';
            layout.subtitle = 'How much money does a single person have leftover after paying for essentials?';
            Plotly.newPlot('singlenet', [trace], layout);
            trace.z = data.map(row => row['Difference in Cost of Family vs Being Single']);
            trace.colorscale = less_is_green;
            layout.title = 'Difference in Cost of Family vs Being Single<br><sup>How much more expensive is it to have a family?</sup>';
            layout.subtitle = 'How much more expensive is it to have a family?';
            Plotly.newPlot('family-single', [trace], layout);
            trace.z = data.map(row => row['Leftover Income for Family vs Single Person']);
            trace.colorscale = more_is_green;
            layout.title = 'Leftover Income for Family vs Single Person<br><sup>How much better are families doing compared to a single person?</sup>';
            layout.subtitle = 'How much better are families doing compared to a single person?';
            Plotly.newPlot('net-family-single', [trace], layout);
            trace.z = data.map(row => row['Yearly Studio Rent']);
            trace.colorscale = less_is_green;
            layout.title = 'Yearly Studio Rent<br><sup>How much does it cost to rent a studio apartment in each state?</sup>';
            layout.subtitle = 'How much does it cost to rent a studio apartment in each state?';
            Plotly.newPlot('studio-rent', [trace], layout);
            trace.z = data.map(row => row['Yearly 4 Bedroom Rent']);
            layout.title = 'Yearly 4 Bedroom Rent<br><sup>How much does it cost to rent a 4 bedroom in each state?</sup>';
            layout.subtitle = 'How much does it cost to rent a 4 bedroom apartment in each state?';
            Plotly.newPlot('4-bedroom-rent', [trace], layout);

            trace.z = data.map(row => row['Percent Income Used On Essentials Family']);
            trace.colorscale = less_is_green;
            layout.title = 'Percent Income Used On Essentials for Family of Four';
            layout.subtitle = '';
            Plotly.newPlot('essentials-family', [trace], layout);
            trace.z = data.map(row => row['Percent Income Used On Essentials Single']);
            layout.title = 'Percent Income Used On Essentials for Single Person';
            Plotly.newPlot('essentials-single', [trace], layout);
            trace.z = data.map(row => row['Average Percent Income Used On Essentials']);
            layout.title = 'Average Percent Income Used On Essentials<br><sup>(Percent Income Used On Essentials for Family of Four + Percent Income Used On Essentials for Single Person) / 2</sup>';
            Plotly.newPlot('avg-essentials', [trace], layout);
            trace.z = data.map(row => row['Average Income Leftover']);
            trace.colorscale = more_is_green;
            layout.title = 'Average Income Leftover<br><sup>(Income of Family + Single Person) / 2</sup>';
            layout.subtitle = 'Income of Family + Single Person / 2';
            Plotly.newPlot('avg-income-leftover', [trace], layout);
            trace.z = data.map(row => row['Yearly Childcare']);
            trace.colorscale = less_is_green;
            layout.title = 'Yearly Childcare';
            Plotly.newPlot('childcare', [trace], layout);

            trace.z = data.map(row => row['Child Tax Credit']);
            trace.colorscale = more_is_green_small_range;
            layout.title = 'Child Tax Credit';
            Plotly.newPlot('child-tax-credit', [trace], layout);

            trace.z = data.map(row => row['Yearly Grocery']);
            trace.colorscale = less_is_green;
            layout.title = 'Yearly Grocery';
            Plotly.newPlot('grocery', [trace], layout);

            trace.z = data.map(row => row['Yearly Water']);
            layout.title = 'Yearly Water';
            Plotly.newPlot('water', [trace], layout);

            trace.z = data.map(row => row['Yearly Electricity']);
            layout.title = 'Yearly Electricity';
            Plotly.newPlot('electricity', [trace], layout);

            trace.z = data.map(row => row['Yearly Internet']);
            layout.title = 'Yearly Internet';
            Plotly.newPlot('internet', [trace], layout);

            trace.z = data.map(row => row['Yearly Mobile Plan Tax Rate']);
            layout.title = 'Yearly Mobile Plan Tax Rate';
            Plotly.newPlot('mobile-plan', [trace], layout);

            trace.z = data.map(row => row['Yearly Cost for 1 Car']);
            layout.title = 'Yearly Cost for 1 Car';
            Plotly.newPlot('car', [trace], layout);

            trace.z = data.map(row => row['Yearly Healthcare']);
            layout.title = 'Yearly Healthcare';
            Plotly.newPlot('healthcare', [trace], layout);

            let headers = [
                "State",
                "Total Cost for Family of 4",
                "Median Family Income",
                "Leftover Income for Family of Four",
                "Total Cost for Single Person",
                "Median Single Income",
                "Leftover Income for Single Person",
                "Difference in Cost of Family vs Being Single",
                "Leftover Income for Family vs Single Person",
                "Percent Income Used On Essentials Family",
                "Percent Income Used On Essentials Single",
                "Average Percent Income Used On Essentials",
                "Average Income Leftover"
            ];
            let table = d3.select("#myData");
            let thead = table.append("thead").append("tr");
            headers.forEach(h => thead.append("th").text(h));
            let tbody = table.append("tbody");
            data.forEach(row => {
                let tr = tbody.append("tr");
                headers.forEach(h => {
                    let value = row[h];
                    let num = parseFloat(value);
                    if (!isNaN(num)) {
                        value = num.toFixed(2);
                    }
                    tr.append("td").text(value);
                });
            });
            $('#myData').DataTable();

            document.getElementById("downloadBtn").addEventListener("click", function() {
                let allRows = [];
                allRows.push(headers.join(","));
                data.forEach(row => {
                    let rowData = headers.map(h => row[h]);
                    allRows.push(rowData.join(","));
                });
                let csvContent = allRows.join("\n");
                let blob = new Blob([csvContent], { type: "text/csv" });
                let url = URL.createObjectURL(blob);
                let link = document.createElement("a");
                link.href = url;
                link.download = "table_data.csv";
                link.click();
                URL.revokeObjectURL(url);
            });
            document.getElementById("downloadBtnRaw").addEventListener("click", function() {
                let link = document.createElement("a");
                link.href = "https://raw.githubusercontent.com/mahi-pas/Economic-Efficacy/refs/heads/main/MyData/final_dataset.csv";
                link.download = "final_dataset.csv";
                link.click();
            });
        });
    </script>
</body>
</html>
